import { Address, TypedMap } from '@graphprotocol/graph-ts';

export let PermitRoutersByPool = new TypedMap<string, Address>();
{{#each pools}}
{{#ifAddress permitRouter}}
PermitRoutersByPool.set('{{address}}'.toLowerCase(), Address.fromString('{{permitRouter}}'));
{{/ifAddress}}
{{/each}}

export let FarmingHelpersByPool = new TypedMap<string, Address>();
{{#each pools}}
{{#ifAddress farmingHelper}}
FarmingHelpersByPool.set('{{address}}'.toLowerCase(), Address.fromString('{{farmingHelper}}'));
{{/ifAddress}}
{{/each}}

export let ClipperFeeSplitAddressesByDirectExchange = new TypedMap<string, Array<string>>();
{{#each pools}}
let feeSplitsForPool{{@index}} = new Array<string>();
{{#ifAddress feeSplit}}
feeSplitsForPool{{@index}}.push('{{feeSplit}}'.toLowerCase());
{{/ifAddress}}
{{#ifAddress farmFeeSplit}}
feeSplitsForPool{{@index}}.push('{{farmFeeSplit}}'.toLowerCase());
{{/ifAddress}}
ClipperFeeSplitAddressesByDirectExchange.set('{{address}}'.toLowerCase(), feeSplitsForPool{{@index}});
{{/each}}

export let PriceOracleByToken = new TypedMap<Address, Address>()
export let TokenByOracle = new TypedMap<Address, Address>()
export let OracleStartBlocks = new TypedMap<Address, string>()
{{#each priceOracles as | oracle |}}
{{#each oracle.tokens}}
PriceOracleByToken.set(Address.fromString('{{this}}'), Address.fromString('{{oracle.address}}'))
TokenByOracle.set(Address.fromString('{{oracle.address}}'), Address.fromString('{{this}}'))
{{/each}}
{{#if oracle.startBlock}}
OracleStartBlocks.set(Address.fromString('{{oracle.address}}'), '{{oracle.startBlock}}')
{{/if}}
{{/each}}


export let FallbackAssetPrice = new TypedMap<Address, string>()
{{#each fallbackPrices}}
FallbackAssetPrice.set(Address.fromString('{{@key}}'), '{{this}}')
{{/each}}

// Add daily fallback prices
export let DailyFallbackPrices = new TypedMap<Address, TypedMap<string, string>>()
{{#each dailyFallbackPrices}}
let prices_{{@key}} = new TypedMap<string, string>()
{{#each this}}
prices_{{tokenAddress}}.set('{{timestamp}}', '{{price}}')
{{/each}}
DailyFallbackPrices.set(Address.fromString('{{@key}}'), prices_{{@key}})
{{/each}}

export let AddressZeroSymbol = '{{addressZeroMap.symbol}}'
export let AddressZeroAddress = '{{addressZeroMap.address}}'
export let AddressZeroDecimals = '{{addressZeroMap.decimals}}'
export let AddressZeroName = '{{addressZeroMap.name}}'
